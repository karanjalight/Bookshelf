(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,,function(e,t,a){e.exports=a(21)},,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(8),i=a.n(r),c=(a(17),a(10)),s=a(2),l=a(3),u=a(5),m=a(4),h=a(6),d=a(1),p=a.n(d),b=(a(18),a(9)),f=(a(19),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this))).submitBook=function(e){e.preventDefault(),p.a.ajax({url:"/books",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({title:a.state.title,author:a.state.author,rating:a.state.rating}),xhrFields:{withCredentials:!0},crossDomain:!0,success:function(e){document.getElementById("add-book-form").reset()},error:function(e){alert("Unable to add book. Please try your request again")}})},a.handleSearch=function(e){e.preventDefault(),a.props.searchBooks(a.state.search)},a.handleChange=function(e){a.setState(Object(b.a)({},e.target.name,e.target.value))},a.state={title:"",author:"",rating:1,search:""},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{id:"form-view"},o.a.createElement("div",{className:"search",style:{display:"None"}},o.a.createElement("h2",null,"Search"),o.a.createElement("form",{className:"FormView",id:"search-form",onSubmit:this.handleSearch},o.a.createElement("input",{type:"text",name:"search",onChange:this.handleChange}),o.a.createElement("input",{type:"submit",className:"button",value:"Submit"}))),o.a.createElement("h2",null,"Add a New Book"),o.a.createElement("form",{className:"FormView",id:"add-book-form",onSubmit:this.submitBook},o.a.createElement("label",null,"Title",o.a.createElement("input",{type:"text",name:"title",onChange:this.handleChange})),o.a.createElement("label",null,"Author",o.a.createElement("input",{type:"text",name:"author",onChange:this.handleChange})),o.a.createElement("label",null,"Rating",o.a.createElement("select",{name:"rating",onChange:this.handleChange},o.a.createElement("option",{value:"1"},"1"),o.a.createElement("option",{value:"2"},"2"),o.a.createElement("option",{value:"3"},"3"),o.a.createElement("option",{value:"4"},"4"),o.a.createElement("option",{value:"5"},"5"))),o.a.createElement("input",{type:"submit",className:"button",value:"Submit"})))}}]),t}(n.Component)),k=(a(20),[5,4,3,2,1]),g=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"createStars",value:function(){var e=this,t=this.props,a=t.id,n=t.rating,r=t.deleteBook;return o.a.createElement("div",{className:"rating"},k.map(function(t){return o.a.createElement("div",{key:t,onClick:function(){e.props.changeRating(e.props.id,t)},className:"star ".concat(n>=t?"active":"")})}),o.a.createElement("div",{className:"delete",onClick:function(){r(a)}}))}},{key:"render",value:function(){var e=this.props,t=e.title,a=e.author;return o.a.createElement("div",{className:"book"},o.a.createElement("div",{className:"cover"},o.a.createElement("div",{className:"title"},t)),o.a.createElement("div",{className:"author"},a),this.createStars())}}]),t}(n.Component),v=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this))).getBooks=function(){p.a.ajax({url:"/books?page=".concat(a.state.page),type:"GET",success:function(e){a.setState({totalBooks:e.total_books,books:e.books})},error:function(e){alert("Unable to load books. Please try your request again")}})},a.deleteBook=function(e){window.confirm("Are you sure you want to delete the book?")&&p.a.ajax({url:"/books/".concat(e),type:"DELETE",success:function(e){a.getBooks()},error:function(e){alert("Unable to delete the book.")}})},a.changeRating=function(e,t){var n=Object(c.a)(a.state.books),o=n.find(function(t){return t.id===e});p.a.ajax({url:"/books/".concat(e),type:"PATCH",dataType:"json",contentType:"application/json",data:JSON.stringify({rating:t}),success:function(e){o.rating=t,a.setState({books:n})},error:function(e){alert("Unable to update the rating.")}})},a.searchBooks=function(e){p.a.ajax({url:"/books",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({search:e}),xhrFields:{withCredentials:!0},crossDomain:!0,success:function(e){a.setState({totalBooks:e.total_books,books:e.books,page:1}),document.getElementById("search-form").reset()},error:function(e){alert("Unable to complete search. Please try your request again")}})},a.state={page:1,totalBooks:0,books:[]},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getBooks()}},{key:"selectPage",value:function(e){var t=this;this.setState({page:e},function(){return t.getBooks()})}},{key:"createPagination",value:function(){for(var e=this,t=[],a=Math.ceil(this.state.totalBooks/8),n=function(a){t.push(o.a.createElement("div",{key:a,className:"page-num ".concat(a===e.state.page?"active":""),onClick:function(){e.selectPage(a)}},a))},r=1;r<=a;r++)n(r);return t}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"App"},o.a.createElement("div",{id:"main-view"},o.a.createElement("div",{className:"bookshelf-container"},this.state.books.map(function(t){return o.a.createElement(g,Object.assign({key:t.id,deleteBook:e.deleteBook,changeRating:e.changeRating},t))})),o.a.createElement("div",{className:"pagination-menu"},this.createPagination())),o.a.createElement(f,{searchBooks:this.searchBooks}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(v,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[11,1,2]]]);
//# sourceMappingURL=main.e96bcd63.chunk.js.map